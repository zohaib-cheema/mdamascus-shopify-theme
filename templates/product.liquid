{% comment %}
  The product page template
{% endcomment %}

<div class="product-page">
  <!-- Product Layout with Side-by-Side Design -->
  {%- if product.media.size > 0 -%}
    <div class="product-main-section">
      <div class="page-width">
        <div class="product-layout">
          <!-- Left Side - Slideshow -->
          <div class="product-slideshow-container">
            <div class="product-slideshow">
              <div class="slideshow-container">
                {%- for media in product.media -%}
                  <div class="slide {% if forloop.first %}active{% endif %}">
                    {%- case media.media_type -%}
                      {%- when 'image' -%}
                        <img
                          src="{{ media | image_url: width: 1200 }}"
                          alt="{{ media.alt | escape }}"
                          loading="{% if forloop.first %}eager{% else %}lazy{% endif %}"
                          width="{{ media.width }}"
                          height="{{ media.height }}"
                        >
                      {%- when 'video' -%}
                        {{ media | video_tag: controls: true }}
                      {%- when 'external_video' -%}
                        {{ media | external_video_tag }}
                      {%- when 'model' -%}
                        {{ media | model_viewer_tag }}
                    {%- endcase -%}
                  </div>
                {%- endfor -%}
              </div>
              
              <!-- Slideshow Navigation -->
              {%- if product.media.size > 1 -%}
                <div class="slideshow-nav">
                  <button class="nav-btn prev-btn" aria-label="Previous image">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                      <path d="M15 18L9 12L15 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                  </button>
                  <button class="nav-btn next-btn" aria-label="Next image">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                      <path d="M9 18L15 12L9 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                  </button>
                </div>
                
                <!-- Slide Indicators -->
                <div class="slide-indicators">
                  {%- for media in product.media -%}
                    <button class="indicator {% if forloop.first %}active{% endif %}" data-slide="{{ forloop.index0 }}" aria-label="Go to slide {{ forloop.index }}"></button>
                  {%- endfor -%}
                </div>
              {%- endif -%}
            </div>
          </div>

          <!-- Right Side - Product Info -->
          <div class="product-info-container">
            <div class="product-info">
        <h1 class="product-title">{{ product.title }}</h1>
        
        {%- if product.vendor != blank -%}
          <p class="product-vendor">{{ product.vendor }}</p>
        {%- endif -%}

        <div class="product-price">
          {%- if product.compare_at_price > product.price -%}
            <span class="price price--sale">{{ product.price | money }}</span>
            <span class="price price--compare">{{ product.compare_at_price | money }}</span>
          {%- else -%}
            <span class="price">{{ product.price | money }}</span>
          {%- endif -%}
        </div>

        {%- form 'product', product, id: 'product-form', class: 'form', novalidate: 'novalidate', data-type: 'add-to-cart-form' -%}
          <input type="hidden" name="id" value="{{ product.selected_or_first_available_variant.id }}">
          <input type="hidden" name="quantity" value="1">
          <div class="product-form__buttons">
            <button
              type="submit"
              name="add"
              class="product-form__cart-submit button button--full-width button--primary"
              {% if product.selected_or_first_available_variant.available == false %}disabled{% endif %}
            >
              <span>
                {%- if product.selected_or_first_available_variant.available -%}
                  {{ 'products.product.add_to_cart' | t }}
                {%- else -%}
                  {{ 'products.product.sold_out' | t }}
                {%- endif -%}
              </span>
              <div class="loading-overlay__spinner hidden">
                <svg aria-hidden="true" focusable="false" class="spinner" viewBox="0 0 66 66" xmlns="http://www.w3.org/2000/svg">
                  <circle class="path" fill="none" stroke-width="6" cx="33" cy="33" r="30"></circle>
                </svg>
              </div>
            </button>
          </div>
        {%- endform -%}

        {%- if product.description != blank -%}
          <div class="product-description">
            {{ product.description }}
          </div>
        {%- endif -%}

        {%- if product.metafields.custom.product_features != blank -%}
          <div class="product-features">
            <h3>{{ 'products.product.features' | t }}</h3>
            {{ product.metafields.custom.product_features }}
          </div>
        {%- endif -%}
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Product Details Continuation Section -->
    <div class="product-details-section">
      <div class="page-width">
        <div class="product-details-content">
          {%- if product.description != blank -%}
            <div class="product-description">
              <h3>Product Description</h3>
              {{ product.description }}
            </div>
          {%- endif -%}

          {%- if product.metafields.custom.product_features != blank -%}
            <div class="product-features">
              <h3>{{ 'products.product.features' | t }}</h3>
              {{ product.metafields.custom.product_features }}
            </div>
          {%- endif -%}
        </div>
      </div>
    </div>
  {%- endif -%}
</div>

<style>
  .product-page {
    padding: 0;
    padding-top: 6rem; /* Add space to account for fixed header */
  }

  /* Main Product Section - Side by Side Layout */
  .product-main-section {
    padding: 2rem 0 4rem;
    background: var(--color-dark);
    min-height: 80vh;
  }

  .product-layout {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 4rem;
    align-items: start;
    max-width: 1400px;
    margin: 0 auto;
  }

  /* Left Side - Slideshow */
  .product-slideshow-container {
    position: sticky;
    top: 8rem; /* Account for header height */
    height: fit-content;
  }

  .product-slideshow {
    position: relative;
    width: 100%;
    border-radius: 1rem;
    overflow: hidden;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
  }

  .slideshow-container {
    position: relative;
    width: 100%;
    height: 500px;
    overflow: hidden;
  }

  .slide {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    opacity: 0;
    transition: opacity 0.5s ease-in-out;
  }

  .slide.active {
    opacity: 1;
  }

  .slide img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  /* Slideshow Navigation */
  .slideshow-nav {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    width: 100%;
    display: flex;
    justify-content: space-between;
    padding: 0 1rem;
    pointer-events: none;
  }

  .nav-btn {
    width: 50px;
    height: 50px;
    background: rgba(0, 0, 0, 0.7);
    border: none;
    border-radius: 50%;
    color: white;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
    pointer-events: auto;
    backdrop-filter: blur(10px);
  }

  .nav-btn:hover {
    background: rgba(255, 107, 53, 0.8);
    transform: scale(1.1);
  }

  /* Slide Indicators */
  .slide-indicators {
    position: absolute;
    bottom: 1rem;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    gap: 0.5rem;
    z-index: 10;
  }

  .indicator {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    border: none;
    background: rgba(255, 255, 255, 0.4);
    cursor: pointer;
    transition: all 0.3s ease;
  }

  .indicator.active {
    background: var(--color-primary);
    transform: scale(1.2);
  }

  .indicator:hover {
    background: rgba(255, 107, 53, 0.7);
  }

  /* Right Side - Product Info */
  .product-info-container {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 2rem 0;
  }

  .product-info {
    width: 100%;
    text-align: left;
  }

  .product-title {
    font-size: 2.5rem;
    margin-bottom: 1.5rem;
    color: var(--color-base-text);
  }

  .product-vendor {
    color: var(--color-base-text);
    opacity: 0.7;
    margin-bottom: 1.5rem;
  }

  .product-price {
    margin-bottom: 2.5rem;
  }

  .price--sale {
    color: var(--color-base-accent-1);
    font-weight: bold;
  }

  .price--compare {
    text-decoration: line-through;
    opacity: 0.7;
    margin-left: 0.5rem;
  }

  .product-description {
    margin-bottom: 2.5rem;
    line-height: 1.6;
  }

  .product-form__buttons {
    margin-bottom: 2.5rem;
  }

  .button--full-width {
    width: 100%;
    padding: 1rem 2rem;
    background-color: var(--color-base-accent-1);
    color: var(--color-base-background-1);
    border: none;
    border-radius: 0.5rem;
    font-size: 1.1rem;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.3s ease;
  }

  .button--full-width:hover {
    opacity: 0.9;
    transform: translateY(-2px);
  }

  .button--full-width:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }

  .product-features {
    margin-top: 3rem;
    padding-top: 2.5rem;
    border-top: 1px solid var(--color-base-background-2);
  }

  /* Product Details Continuation Section */
  .product-details-section {
    padding: 4rem 0 6rem;
    background: var(--color-dark-light);
  }

  .product-details-content {
    max-width: 1000px;
    margin: 0 auto;
  }

  .product-details-content h3 {
    margin-bottom: 1.5rem;
    color: var(--color-base-text);
    font-size: 1.8rem;
  }

  .product-description {
    margin-bottom: 3rem;
  }

  .product-features h3 {
    margin-bottom: 1.5rem;
    color: var(--color-base-text);
  }

  /* Responsive Design */
  @media screen and (max-width: 1200px) {
    .product-layout {
      gap: 3rem;
      max-width: 1200px;
    }
    
    .slideshow-container {
      height: 450px;
    }
  }

  @media screen and (max-width: 1024px) {
    .product-layout {
      gap: 2rem;
    }
    
    .slideshow-container {
      height: 400px;
    }
    
    .product-title {
      font-size: 2.2rem;
    }
  }

  @media screen and (max-width: 768px) {
    .product-page {
      padding-top: 5rem;
    }
    
    .product-main-section {
      padding: 1rem 0 3rem;
    }
    
    .product-layout {
      grid-template-columns: 1fr;
      gap: 2rem;
    }
    
    .product-slideshow-container {
      position: static;
      order: 1;
    }
    
    .product-info-container {
      order: 2;
      padding: 1rem 0;
    }
    
    .product-info {
      text-align: center;
    }
    
    .slideshow-container {
      height: 350px;
    }
    
    .product-title {
      font-size: 2rem;
    }
    
    .nav-btn {
      width: 40px;
      height: 40px;
    }
    
    .nav-btn svg {
      width: 20px;
      height: 20px;
    }
  }

  @media screen and (max-width: 480px) {
    .product-page {
      padding-top: 4rem;
    }
    
    .slideshow-container {
      height: 300px;
    }
    
    .product-title {
      font-size: 1.8rem;
    }
    
    .product-details-section {
      padding: 3rem 0 4rem;
    }
  }
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const slides = document.querySelectorAll('.slide');
  const indicators = document.querySelectorAll('.indicator');
  const prevBtn = document.querySelector('.prev-btn');
  const nextBtn = document.querySelector('.next-btn');
  
  if (slides.length === 0) return;
  
  let currentSlide = 0;
  
  function showSlide(index) {
    // Remove active class from all slides and indicators
    slides.forEach(slide => slide.classList.remove('active'));
    indicators.forEach(indicator => indicator.classList.remove('active'));
    
    // Add active class to current slide and indicator
    slides[index].classList.add('active');
    if (indicators[index]) {
      indicators[index].classList.add('active');
    }
    
    currentSlide = index;
  }
  
  function nextSlide() {
    const next = (currentSlide + 1) % slides.length;
    showSlide(next);
  }
  
  function prevSlide() {
    const prev = currentSlide === 0 ? slides.length - 1 : currentSlide - 1;
    showSlide(prev);
  }
  
  // Event listeners
  if (nextBtn) {
    nextBtn.addEventListener('click', nextSlide);
  }
  
  if (prevBtn) {
    prevBtn.addEventListener('click', prevSlide);
  }
  
  // Indicator click events
  indicators.forEach((indicator, index) => {
    indicator.addEventListener('click', () => {
      showSlide(index);
    });
  });
  
  // Keyboard navigation
  document.addEventListener('keydown', (e) => {
    if (e.key === 'ArrowLeft') {
      prevSlide();
    } else if (e.key === 'ArrowRight') {
      nextSlide();
    }
  });
  
  // Touch/swipe support for mobile
  let touchStartX = 0;
  let touchEndX = 0;
  
  const slideshow = document.querySelector('.slideshow-container');
  if (slideshow) {
    slideshow.addEventListener('touchstart', (e) => {
      touchStartX = e.changedTouches[0].screenX;
    });
    
    slideshow.addEventListener('touchend', (e) => {
      touchEndX = e.changedTouches[0].screenX;
      handleSwipe();
    });
  }
  
  function handleSwipe() {
    const swipeThreshold = 50;
    const diff = touchStartX - touchEndX;
    
    if (Math.abs(diff) > swipeThreshold) {
      if (diff > 0) {
        nextSlide(); // Swipe left - next slide
      } else {
        prevSlide(); // Swipe right - previous slide
      }
    }
  }
});
</script>
 
 <div id='Areviewsapp' class='page-full'>{%  render 'aliexpress_reviews' , product: product %}</div>